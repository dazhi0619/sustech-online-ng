<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.7" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="icon" href="/logo-assets/touch/homescreen192.png"><meta name="theme-color" content="#49BF7C"><link rel="manifest" href="/manifest.webmanifest"><meta prefix="og: http://ogp.me/ns#" property="og:type" content="article"><meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://mirrors.sustech.edu.cn/git/sustech-online/sustech-online-ng/-/raw/master/docs/assets/og-image.png"><meta prefix="og: http://ogp.me/ns#" property="og:article:author" content="sustech.online"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/logo-assets/touch/homescreen168.png"><meta name="msapplication-TileImage" content="/logo-assets/touch/homescreen144.png"><meta name="msapplication-TileColor" content="#49BF7C"><meta name="google-site-verification" content="Av-srANCmFA_yZ8Iasa1yQsIPJCF_zlP5AoD35m6_Ww"><script async src="https://googletagmanager.com/gtag/js?id=G-1BQBXDGY3R"></script><script>
                        window.dataLayer = window.dataLayer || [];
                        function gtag(){dataLayer.push(arguments);}
                        gtag('js', new Date());
                        gtag('config', 'G-1BQBXDGY3R');
                        </script><script src="/wx_helper.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script><script src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/jquery/3.6.0/jquery.min.js"></script><script src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script><link rel="stylesheet" type="text/css" href="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"><script src="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"></script><link rel="stylesheet" type="text/css" href="https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/datatables/1.10.21/css/jquery.dataTables.min.css"><title>校内 IPv6 设置教程 | 南科手册</title><meta name="description" content="Online manual for sustecher">
    <link rel="preload" href="/assets/style-v3804vm3.css" as="style"><link rel="stylesheet" href="/assets/style-v3804vm3.css">
    <link rel="modulepreload" href="/assets/app-wE5cXhyZ.js"><link rel="modulepreload" href="/assets/index.html-cC2us4N3.js">
    <link rel="prefetch" href="/assets/index.html-aSmFtwz3.js" as="script"><link rel="prefetch" href="/assets/index-wx.html-plypHLC-.js" as="script"><link rel="prefetch" href="/assets/index.html-YMb95JFn.js" as="script"><link rel="prefetch" href="/assets/2018-2019.html-O6UaNpX7.js" as="script"><link rel="prefetch" href="/assets/2019-2020.html-1yGl3UNH.js" as="script"><link rel="prefetch" href="/assets/2020-2021.html-Kx7WIvtK.js" as="script"><link rel="prefetch" href="/assets/2021-2022.html-V_PHf9Aq.js" as="script"><link rel="prefetch" href="/assets/2021fall.html-Ys_0yAQY.js" as="script"><link rel="prefetch" href="/assets/2022-2023.html-Tk9xkyH6.js" as="script"><link rel="prefetch" href="/assets/2023-2024.html-LwYcLeXK.js" as="script"><link rel="prefetch" href="/assets/index.html-317U07oz.js" as="script"><link rel="prefetch" href="/assets/index.html-ER46NLvj.js" as="script"><link rel="prefetch" href="/assets/canteen-wx.html-gES5CwP6.js" as="script"><link rel="prefetch" href="/assets/index.html-nlNn1f3f.js" as="script"><link rel="prefetch" href="/assets/index.html-lOe2s54J.js" as="script"><link rel="prefetch" href="/assets/index.html-6aG1M2L5.js" as="script"><link rel="prefetch" href="/assets/building-11-elevator.html-Lsdyc6mn.js" as="script"><link rel="prefetch" href="/assets/2021.html-mvtVvjGD.js" as="script"><link rel="prefetch" href="/assets/index.html-YCNLw5IJ.js" as="script"><link rel="prefetch" href="/assets/index.html-V8JqSS3F.js" as="script"><link rel="prefetch" href="/assets/vehicle-charger.html-oo0biMXj.js" as="script"><link rel="prefetch" href="/assets/index.html-TSmm3-Aa.js" as="script"><link rel="prefetch" href="/assets/index.html-d0XQOT64.js" as="script"><link rel="prefetch" href="/assets/index.html-LIEMrp0i.js" as="script"><link rel="prefetch" href="/assets/index.html-LZz2x4lE.js" as="script"><link rel="prefetch" href="/assets/registered-organization-2019.html-vfiNQ4Nq.js" as="script"><link rel="prefetch" href="/assets/registered-organization-2020.html-WaruiWoY.js" as="script"><link rel="prefetch" href="/assets/registered-organization-2021.html-0xwMi7G9.js" as="script"><link rel="prefetch" href="/assets/index.html-moBAp1iY.js" as="script"><link rel="prefetch" href="/assets/index.html-iiYQQDa-.js" as="script"><link rel="prefetch" href="/assets/adt.html-SVMS8m08.js" as="script"><link rel="prefetch" href="/assets/index.html-MqleogDK.js" as="script"><link rel="prefetch" href="/assets/paper-tools.html-WXhEj242.js" as="script"><link rel="prefetch" href="/assets/index.html-5-_E-wnT.js" as="script"><link rel="prefetch" href="/assets/index.html-VMIYO9pI.js" as="script"><link rel="prefetch" href="/assets/bustimer-old.html-On3HGHKk.js" as="script"><link rel="prefetch" href="/assets/bustimer-wx.html-Ol6NliJc.js" as="script"><link rel="prefetch" href="/assets/bustimer.html-f4cjN4qN.js" as="script"><link rel="prefetch" href="/assets/holiday.html-fnttXL3b.js" as="script"><link rel="prefetch" href="/assets/redirect.html-NJ4Dw2G-.js" as="script"><link rel="prefetch" href="/assets/workday.html-0nGJOZ7P.js" as="script"><link rel="prefetch" href="/assets/index.html-YTS0QE2K.js" as="script"><link rel="prefetch" href="/assets/index.html-GhKxxnNy.js" as="script"><link rel="prefetch" href="/assets/index.html-fw6bm7uM.js" as="script"><link rel="prefetch" href="/assets/新生攻略之宿舍生活篇.html-YTsGnCBK.js" as="script"><link rel="prefetch" href="/assets/新生攻略之校内介绍篇.html-vQ92hYZo.js" as="script"><link rel="prefetch" href="/assets/新生攻略之社团篇.html-9A8DpT7j.js" as="script"><link rel="prefetch" href="/assets/index.html-I_vuPdwO.js" as="script"><link rel="prefetch" href="/assets/index.html-3LgI9Q5X.js" as="script"><link rel="prefetch" href="/assets/dorm-floor-plan.html-Dotj84-h.js" as="script"><link rel="prefetch" href="/assets/index.html-aNUtkDpg.js" as="script"><link rel="prefetch" href="/assets/index.html--vIiSDxn.js" as="script"><link rel="prefetch" href="/assets/index.html-zFozv9_H.js" as="script"><link rel="prefetch" href="/assets/index.html-yuA5Sz9c.js" as="script"><link rel="prefetch" href="/assets/send-receive-email-by-proxy.html-_DGCfO47.js" as="script"><link rel="prefetch" href="/assets/index.html-dY1Stgcd.js" as="script"><link rel="prefetch" href="/assets/index.html-MtOGlrn3.js" as="script"><link rel="prefetch" href="/assets/index.html-u76XlZk4.js" as="script"><link rel="prefetch" href="/assets/index.html-xgUP4kAz.js" as="script"><link rel="prefetch" href="/assets/index.html-bSpe5HsO.js" as="script"><link rel="prefetch" href="/assets/index.html-cSmyemlJ.js" as="script"><link rel="prefetch" href="/assets/index.html-Yq9-vXgu.js" as="script"><link rel="prefetch" href="/assets/index.html-_Yrvqf4E.js" as="script"><link rel="prefetch" href="/assets/index.html-JPqwimbN.js" as="script"><link rel="prefetch" href="/assets/index.html-aupmhpgO.js" as="script"><link rel="prefetch" href="/assets/index.html-2H_v7hfC.js" as="script"><link rel="prefetch" href="/assets/index.html-kohnQjuV.js" as="script"><link rel="prefetch" href="/assets/advice-on-study.html-b6jNU4cI.js" as="script"><link rel="prefetch" href="/assets/info-on-study.html-zAB22uQv.js" as="script"><link rel="prefetch" href="/assets/新生攻略之学习篇.html-5ofBXRi3.js" as="script"><link rel="prefetch" href="/assets/innovative-project.html-WIq_EsQH.js" as="script"><link rel="prefetch" href="/assets/index.html-BahB4EF3.js" as="script"><link rel="prefetch" href="/assets/index.html-STugj8N_.js" as="script"><link rel="prefetch" href="/assets/index.html-z2imfTZR.js" as="script"><link rel="prefetch" href="/assets/index.html-yV5eYdDx.js" as="script"><link rel="prefetch" href="/assets/index.html-aKes91u9.js" as="script"><link rel="prefetch" href="/assets/index.html-gtHaH2Ae.js" as="script"><link rel="prefetch" href="/assets/index.html-elQClPtM.js" as="script"><link rel="prefetch" href="/assets/index.html-S7srqPVU.js" as="script"><link rel="prefetch" href="/assets/404.html-2X50tT5b.js" as="script"><link rel="prefetch" href="/assets/style-w40geAFS.js" as="script"><link rel="prefetch" href="/assets/docsearch-w40geAFS.js" as="script"><link rel="prefetch" href="/assets/index-QOy62Fup.js" as="script"><link rel="prefetch" href="/assets/index-7SG8bi1h.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="site-name" aria-hidden="true">南科手册</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://daily.sustech.online/" rel="noopener noreferrer" target="_blank" aria-label="快讯网"><!--[--><!--]--> 快讯网 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/miniapp/" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/about/" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/site-help/" aria-label="站点帮助"><!--[--><!--]--> 站点帮助 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/sustech-cra/sustech-online-ng" rel="noopener noreferrer" target="_blank" aria-label="在Github上查看"><!--[--><!--]--> 在Github上查看 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="切换夜间模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索手册"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索手册</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://daily.sustech.online/" rel="noopener noreferrer" target="_blank" aria-label="快讯网"><!--[--><!--]--> 快讯网 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/miniapp/" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/about/" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/site-help/" aria-label="站点帮助"><!--[--><!--]--> 站点帮助 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/sustech-cra/sustech-online-ng" rel="noopener noreferrer" target="_blank" aria-label="在Github上查看"><!--[--><!--]--> 在Github上查看 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a class="route-link sidebar-item sidebar-heading" href="/" aria-label="📚南科手册"><!--[--><!--]--> 📚南科手册 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/facility/" aria-label="🏫建筑与设施"><!--[--><!--]--> 🏫建筑与设施 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/contact/" aria-label="📇黄页"><!--[--><!--]--> 📇黄页 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/calendar/" aria-label="📅校历"><!--[--><!--]--> 📅校历 <!--[--><!--]--></a><!----></li><li><a class="route-link route-link-active sidebar-item sidebar-heading" href="/service/" aria-label="🖥服务与技巧"><!--[--><!--]--> 🖥服务与技巧 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/life/" aria-label="👨‍🎓生活在南科"><!--[--><!--]--> 👨‍🎓生活在南科 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/study/" aria-label="🎓学在南科"><!--[--><!--]--> 🎓学在南科 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/canteen/" aria-label="🍜饭堂服务"><!--[--><!--]--> 🍜饭堂服务 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/organizations/" aria-label="🎡社团活动"><!--[--><!--]--> 🎡社团活动 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/media/" aria-label="📺媒体与网站"><!--[--><!--]--> 📺媒体与网站 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item sidebar-heading" href="/transport/" aria-label="🚄交通"><!--[--><!--]--> 🚄交通 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/transport/bustimer.html" aria-label="🚌新版巴士时刻表"><!--[--><!--]--> 🚌新版巴士时刻表 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/transport/workday.html" aria-label="🚌校园巴士-工作日"><!--[--><!--]--> 🚌校园巴士-工作日 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/transport/holiday.html" aria-label="🚌校园巴士-节假日"><!--[--><!--]--> 🚌校园巴士-节假日 <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/transport/" aria-label="周围交通"><!--[--><!--]--> 周围交通 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item sidebar-heading" href="/surroundings/" aria-label="🛍周边"><!--[--><!--]--> 🛍周边 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="校内-ipv6-设置教程" tabindex="-1"><a class="header-anchor" href="#校内-ipv6-设置教程"><span>校内 IPv6 设置教程</span></a></h1><p>本篇教程是在南方科技大学的网络环境下写成。据我所知，下发128位前缀 IPv6 地址的学校不止南科大一所，本篇教程事实上具有普适性，其他大学的同学也可以进行参考。</p><p>事实上，在中国电信的家宽一般下发56位前缀的地址，也可使用本方法，但并无必要，可直接由路由分配地址无需 NAT。</p><p>南科大的 IPv6 下发的地址是 128位前缀，换言之，子网大小为 1，仅够一台设备使用。为了让一个物理网口下的多个设备共享网络，常见的解决方案是（1）交换机（2）路由器。两者的区别想必需要用到此教程的同学应该了解，这里仅介绍具体配置。</p><h2 id="ipv6-桥接" tabindex="-1"><a class="header-anchor" href="#ipv6-桥接"><span>IPv6 桥接</span></a></h2><p>根据工信部<a href="https://www.miit.gov.cn/jgsj/txs/wjfb/art/2020/art_ed97eb9802da4f168acb823227663f1b.html" target="_blank" rel="noopener noreferrer">《关于开展2019年IPv6网络就绪专项行动的通知》<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> 的要求，“新部署的家庭网关设备应全部支持IPv6，并默认配置支持IPv4/IPv6双栈，能够为网关下挂设备分配 IPv6 地址”。同学们新购买的路由器应该都支持 IPv6。例如水星等，国产路由器一般会将 IPv6 与 IPv4的设置分开。</p><p>在南科大校园网下，在 IPv6 的设置中选择 “桥接模式” 或 ”中继模式“，下级设备应该能分配到 2001 开头的公网 IPv6 地址。</p><h2 id="ipv6-nat-©️-戴郭轶" tabindex="-1"><a class="header-anchor" href="#ipv6-nat-©️-戴郭轶"><span>IPv6 NAT ©️ 戴郭轶</span></a></h2><p>一些同学如果有特殊需求可能会使用 OpenWrt，里面有丰富的插件提供多样的服务。</p><p>这篇教程可以说是一篇咕咕咕了很久的教程，大概是在去年才开学的时候，当时公网限速在 700KB/s，所以就买了新路由3刷了 OpenWrt 进行多拨来解除限速，（现在解除了，最快能够跑到 90MB/s 左右，没有必要使用多拨来提升带宽）。不过当时也花了很久配置 IPv6 的经验，可能仍值得分享。</p><p>由于南科大的分配的128位前缀的地址，子网空间不足，需要使用本该被淘汰掉的 NAT 网络地址转换使得下级设备能够联网，正确配置后的效果如下：</p><p><img src="/assets/image-Tn--NV9Q.png" alt="img"></p><p>同时北洋园和蒲公英pt均能正常识别（需要在OpenWrt开启 UPnP ）：</p><p><img src="/assets/image-1-enLCWUG_.png" alt="img"></p><p><img src="/assets/image-2-E5XuMcaW.png" alt="img"></p><p><strong>（PS：不要学我IPv6不打码直接发，因为 v6 默认就是公网地址，我在发完教程后会使用新的地址）</strong></p><p>电脑能成功获取内网IPv6,同时手机也能获得64位的 v6 地址，正常访问 v6 网络：</p><p><img src="/assets/image-3-lxfxCfrp.png" alt="img"></p><p>相应的流程并不复杂，只需要一台刷入OpenWrt的路由器，一台电脑，WinSCP（可选），以及足够的耐心。</p><p>首先，我们需要登录进入路由器的后台管理页面,依次点击网络-接口：</p><p>将全局网络选项前缀进行修改，我个人使用的是 <code>fd34:fe56:7891:2f3a::/64</code>；可以按照自己喜好选择一个内网前缀。</p><p><img src="/assets/image-4-1024x143-r1AdkDak.png" alt="img"></p><p>随后单击lan一栏的修改，我们需要修改一下内网的设置，滑到下方，点击高级设置，按照下图进行勾选：</p><p><img src="/assets/image-5-1024x257-Ebc34T6H.png" alt="img"></p><p>然后点击IPv6设置，路由器通告服务和DHCPv6服务修改为服务器模式，NDP代理设置为禁用，DHCPv6选择无状态的+有状态的，并勾选总是通告默认路由：</p><p><img src="/assets/image-6-1024x333-xBg4nvNU.png" alt="img"></p><p>完成后点击保存&amp;应用。</p><p>随后进入wan口的设置，勾选上使用内置的IPv6管理</p><p><img src="/assets/image-7-A3UB4PVN.png" alt="img"></p><p>随后进入wan6口的设置，将协议修改为DHCPv6客户端，请求IPv6地址为force，请求指定长度的IPv6前缀为已禁用：</p><p><img src="/assets/image-8-1024x484-FUvhPpZ8.png" alt="img"></p><p>进入高级设置，勾选上使用内置的IPv6管理，强制链路和使用默认网关：</p><p><img src="/assets/image-9-1024x435-HEkG9ILK.png" alt="img"></p><p>之后选择网络-DHCP/DNS，进入高级设置，取消勾选禁止解析IPv6 DNS记录：</p><p><img src="/assets/image-10-1024x161-5FprX9av.png" alt="img"></p><p>进入网络-防火墙：</p><p>将转发改为接受，下面的区域也需要改：</p><p><img src="/assets/image-11-1024x983-w1eSTSoW.png" alt="img"></p><p>进入自定义规则，粘贴如下内容：</p><p><img src="/assets/image-13-1024x530-vyIsUyfj.png" alt="img"></p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>WAN6=eth0.2
LAN=br-lan
ip6tables -t nat -A POSTROUTING -o $WAN6 -j MASQUERADE
ip6tables -A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中 <code>eth0.2</code> 和 <code>br-lan</code> 需要修改为你网络-接口中显示的内容：</p><p><img src="/assets/image-12-lKG68wdA.png" alt="img"></p><p>2023.3.22 更新：</p><p>在新版本的linux/openwrt 中，iptables 已经被 nftables 取代，上述命令可能执行失败，我们可以使用以下命令来解决： ip6tables -t nat -I POSTROUTING -s `uci get network.globals.ula_prefix` -j MASQUERADE 这样就无需上述防火墙自定义规则的配置了。</p><p>如果有多拨需求的，提醒一下需要在负载均衡中将 defalut-rule 的备用成员改成默认（使用主路由表），由于我重新刷机做的教程且现在没有多拨的必要，就不演示了，没有需求的可以略过这一点。</p><p>经过如上配置，重启路由器后，在网络，诊断中应该能够成功 ping 通 openwrt.org 的v6了，说明你的路由器已经成功接入 IPv6 网络了：</p><p><img src="/assets/image-14-1024x783-YCwUlyLm.png" alt="img"></p><p>但是如果我们打开 <a href="https://www.test-IPv6.com/" target="_blank" rel="noopener noreferrer">https://www.test-IPv6.com/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> ，我们电脑还是没有连上v6的，这里就需要我们修改流量转发的路由表了，使用ssh工具连上路由器，没有的可以点击系统-TTYD终端：依次输入一下代码：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>route <span class="token parameter variable">-A</span> inet6 <span class="token function">add</span> default gw fe80::3e8c:93ff:fed0:83c2 dev eth0.2
/etc/init.d/firewall restart
/etc/init.d/network restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中，第一行的fe80开头的一串v6地址需要修改为本机的默认网关，可以在状态-概览下获得，如图：</p><p><img src="/assets/image-15-1024x173-BLa4ZQw3.png" alt="img"></p><p>而后面的eth0.2就是你网口的编号了，和防火墙哪那里一样，这个时候我们再打开 <a href="https://www.test-IPv6.com/" target="_blank" rel="noopener noreferrer">https://www.test-IPv6.com/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a> ，可以发现，我们电脑已经接入IPv6了：</p><p><img src="/assets/image-16-1024x538-VeFxW03J.png" alt="img"></p><p>但是，如果路由器关机重启后，我们刚才输入的三行代码会丢失，也就是会回到路由器有 IPv6 而电脑无法连接 IPv6 的状态，这个时候我们就需要编辑一个开机自启的脚本，让路由器再开机时自动添加：</p><p>具体操作为：使用 WinSCP 连接并登陆进入路由器，在 <code>/etc/hotplug.d/iface/</code> 目录下新建名为 <code>restart-IPv6</code> 的文件，修改内容为：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ACTION</span>&quot;</span> <span class="token operator">=</span> <span class="token function">ifup</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span>
route <span class="token parameter variable">-A</span> inet6 <span class="token function">add</span> default gw fe80::3e8c:93ff:fed0:83c2 dev eth0.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2023.3.22 更新： 如果无法在防火墙自定义规则处修改，请在脚本中添加相关命令。</p><p>最后一行需要修改成和刚才一样的内容，然后给予可执行权限。</p><p>没有 WinSCP 的可以在终端内输入以下内容：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/hotplug.d/iface/restart-IPv6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后再文本框中输入上面的三行内容，按 Esc 后退出 insert 模式，输入 <code>:wq</code> 退出。</p><p>然后给予可执行权限：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">chmod</span> +x /etc/hotplug.d/iface/restart-IPv6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="/assets/image-18-N2AY0YpI.png" alt="img"></p><p>这个时候，恭喜你，成功配置IPv6了哦~</p><p>对了，如果有挂pt需求的同学，别忘了在服务-UPnP中打开哦~</p><p>还存在一些应该是OpenWrt本身的问题，在使用IPv6的时候，无法手动配置端口转发，UPnP的端口转发是成功的，但是在防火墙下无法配置，使用 Socat 也没有成功。</p><p>感谢阅读！如果有什么问题或者建议，可以和我发邮件联系。</p><p>我的个人邮箱为：ntdgy2001@gmail.com / 12011211@mail.sustech.edu.cn</p><p>原文章地址（NAT 部分）©️ 戴郭轶：[<a href="https://ntdgy.top/ntdgy/30.html" target="_blank" rel="noopener noreferrer">https://ntdgy.top/ntdgy/30/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span></a>]</p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/sustech-cra/sustech-online-ng/edit/master/docs/service/network/ipv6/README.md" rel="noopener noreferrer" target="_blank" aria-label="一起完善这本手册！"><!--[--><!--]--> 一起完善这本手册！ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: leezisy@gmail.com">liziwl</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: dreamwalkerxz@outlook.com">DreamWalkerXZ</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: ntdgy2001@gmail.com">ntdgy</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-wE5cXhyZ.js" defer></script>
  </body>
</html>
